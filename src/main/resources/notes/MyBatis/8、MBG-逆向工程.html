<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/304720 (zh-CN, DDL); Windows/10.0.14393 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3423"/>
<h1>8、MBG-逆向工程</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2017/6/28 14:09</i></td></tr>
<tr><td><b>更新时间：</b></td><td><i>2017/6/28 15:57</i></td></tr>
<tr><td><b>作者：</b></td><td><i>雷丰阳</i></td></tr>
</table>
</div>
<br/>

<div>
<span><div>正向：</div><div>table----javaBean---BookDao---dao.xml---xxx</div><div>逆向工程：</div><div>根据数据表table，逆向分析数据表，自动生成javaBean---BookDao---dao.xml---xxx</div><div><hr/></div><div><br/></div><div>MBG：MyBatis Generator：代码生成器；</div><div>MyBatis官方提供的代码生成器；帮我们逆向生成；</div><div><br/></div><div><hr/></div><div>1、导包：mbg的核心包</div><div>2、编写mbg.xml配置文件</div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div>&lt;!DOCTYPE generatorConfiguration</div><div>  PUBLIC &quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</div><div>  &quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;&gt;</div><div><br/></div><div>&lt;generatorConfiguration&gt;</div><div><br/></div><div>    &lt;!--</div><div>    MyBatis3Simple：基础班CRUD</div><div>    MyBatis3：复杂版CRUD</div><div>     --&gt;</div><div>    &lt;context id=&quot;DB2Tables&quot; targetRuntime=&quot;MyBatis3&quot;&gt;</div><div>        &lt;commentGenerator&gt;</div><div>            &lt;property name=&quot;suppressAllComments&quot; value=&quot;true&quot;/&gt;</div><div>        &lt;/commentGenerator&gt;</div><div>        &lt;!-- jdbcConnection:指导连接到哪个数据库 --&gt;</div><div>        &lt;jdbcConnection<br/></div><div><br/></div><div>            driverClass=&quot;com.mysql.jdbc.Driver&quot;</div><div>            connectionURL=&quot;jdbc:mysql://localhost:3306/mybatis_0325&quot;<br/></div><div><br/></div><div>            userId=&quot;root&quot;<br/></div><div><br/></div><div>            password=&quot;123456&quot;&gt;</div><div>        &lt;/jdbcConnection&gt;</div><div><br/></div><div>        &lt;javaTypeResolver&gt;</div><div>            &lt;property name=&quot;forceBigDecimals&quot; value=&quot;false&quot; /&gt;</div><div>        &lt;/javaTypeResolver&gt;</div><div><br/></div><div>        &lt;!-- javaModelGenerator：生成pojo<br/></div><div><br/></div><div>        targetPackage：生成的pojo放在哪个包</div><div>        targetProject：放在哪个工程下</div><div>        --&gt;</div><div>        &lt;javaModelGenerator targetPackage=&quot;com.atguigu.bean&quot;</div><div>            targetProject=&quot;.\src&quot;&gt;</div><div>            &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot; /&gt;</div><div>            &lt;property name=&quot;trimStrings&quot; value=&quot;true&quot; /&gt;</div><div>        &lt;/javaModelGenerator&gt;</div><div><br/></div><div>        &lt;!--sqlMapGenerator：sql映射文件生成器；指定xml生成的地方  --&gt;</div><div>        &lt;sqlMapGenerator targetPackage=&quot;com.atguigu.dao&quot;</div><div>            targetProject=&quot;.\conf&quot;&gt;</div><div>            &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot; /&gt;</div><div>        &lt;/sqlMapGenerator&gt;</div><div><br/></div><div>        &lt;!-- javaClientGenerator：dao接口生成的地方 --&gt;</div><div>        &lt;javaClientGenerator type=&quot;XMLMAPPER&quot;</div><div>            targetPackage=&quot;com.atguigu.dao&quot;<br/></div><div><br/></div><div>            targetProject=&quot;.\src&quot;&gt;</div><div>            &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot; /&gt;</div><div>        &lt;/javaClientGenerator&gt;</div><div><br/></div><div>        &lt;!-- table：指定要逆向生成哪个数据表</div><div>        tableName=&quot;t_cat&quot;：表名</div><div>        domainObjectName=&quot;&quot;：这个表对应的对象名</div><div>         --&gt;</div><div>        &lt;table tableName=&quot;t_cat&quot; domainObjectName=&quot;Cat&quot;&gt;&lt;/table&gt;</div><div>        &lt;table tableName=&quot;t_employee&quot; domainObjectName=&quot;Employee&quot;&gt;&lt;/table&gt;</div><div>        &lt;table tableName=&quot;t_teacher&quot; domainObjectName=&quot;Teacher&quot;&gt;&lt;/table&gt;</div><div><br/></div><div>    &lt;/context&gt;</div><div>&lt;/generatorConfiguration&gt;</div></div><div><br/></div><div>3、运行代码生成</div><div><br/></div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.atguigu.test;</div><div><br/></div><div>import java.io.File;</div><div>import java.io.IOException;</div><div>import java.util.ArrayList;</div><div>import java.util.List;</div><div><br/></div><div>import org.mybatis.generator.api.MyBatisGenerator;</div><div>import org.mybatis.generator.config.Configuration;</div><div>import org.mybatis.generator.config.xml.ConfigurationParser;</div><div>import org.mybatis.generator.exception.XMLParserException;</div><div>import org.mybatis.generator.internal.DefaultShellCallback;</div><div><br/></div><div>public class MBGTest {</div><div><br/></div><div>    public static void main(String[] args) throws Exception {</div><div>        List&lt;String&gt; warnings = new ArrayList&lt;String&gt;();</div><div>        boolean overwrite = true;</div><div>        File configFile = new File(&quot;mbg.xml&quot;);</div><div>        ConfigurationParser cp = new ConfigurationParser(warnings);</div><div>        Configuration config = cp.parseConfiguration(configFile);</div><div>        DefaultShellCallback callback = new DefaultShellCallback(overwrite);</div><div>        MyBatisGenerator myBatisGenerator = new MyBatisGenerator(config,</div><div>                callback, warnings);</div><div>        //代码生成</div><div>        myBatisGenerator.generate(null);</div><div>        System.out.println(&quot;生成ok了！&quot;);</div><div>    }</div><div><br/></div><div>}</div><div><br/></div></div><div><br/></div><div>4、测试复杂查询</div><div><br/></div><div style="-en-codeblock: true; box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.14902); background-position: initial initial; background-repeat: initial initial;"><div>package com.atguigu.test;</div><div><br/></div><div>import static org.junit.Assert.*;</div><div><br/></div><div>import java.io.IOException;</div><div>import java.io.InputStream;</div><div>import java.util.ArrayList;</div><div>import java.util.Arrays;</div><div>import java.util.Date;</div><div>import java.util.HashMap;</div><div>import java.util.List;</div><div>import java.util.Map;</div><div>import java.util.UUID;</div><div><br/></div><div>import org.apache.ibatis.io.Resources;</div><div>import org.apache.ibatis.session.SqlSession;</div><div>import org.apache.ibatis.session.SqlSessionFactory;</div><div>import org.apache.ibatis.session.SqlSessionFactoryBuilder;</div><div>import org.junit.Before;</div><div>import org.junit.Test;</div><div><br/></div><div>import com.atguigu.bean.Teacher;</div><div>import com.atguigu.bean.TeacherExample;</div><div>import com.atguigu.bean.TeacherExample.Criteria;</div><div>import com.atguigu.dao.TeacherMapper;</div><div><br/></div><div><br/></div><div><br/></div><div>public class MyBatisTest {</div><div><br/></div><div>    // 工厂一个</div><div>    SqlSessionFactory sqlSessionFactory;</div><div><br/></div><div><br/></div><div>    @Test</div><div>    public void test02(){</div><div>        SqlSession sqlSession = sqlSessionFactory.openSession();</div><div>        //1、测试</div><div>        TeacherMapper mapper = sqlSession.getMapper(TeacherMapper.class);</div><div>        List&lt;Teacher&gt; teachers = new ArrayList&lt;Teacher&gt;();</div><div>        for (int i = 0; i &lt; 1000; i++) {</div><div>            Teacher teacher = new Teacher();</div><div>            teacher.setTeachername(UUID.randomUUID().toString().substring(0, 5));</div><div>            teacher.setClassName(UUID.randomUUID().toString().substring(0, 5));</div><div>            teachers.add(teacher);</div><div>        }</div><div>        System.out.println(&quot;批量保存.....&quot;);</div><div>        mapper.insertBatch(teachers);</div><div>        sqlSession.commit();</div><div>        sqlSession.close();</div><div><br/></div><div><br/></div><div>    }</div><div><br/></div><div>    /**</div><div>     * 测试代码生成器</div><div>     * @throws IOException</div><div>     */</div><div>    @Test</div><div>    public void test01(){</div><div>        SqlSession sqlSession = sqlSessionFactory.openSession();</div><div>        //1、测试</div><div>        TeacherMapper mapper = sqlSession.getMapper(TeacherMapper.class);</div><div>        //2、测试查询所有teacher</div><div>        List&lt;Teacher&gt; list = mapper.selectByExample(null);</div><div>        for (Teacher teacher : list) {</div><div>            System.out.println(teacher);</div><div>        }</div><div><br/></div><div>        //3、带复杂条件的查询</div><div>        //select * from t_teacher id=? and teacherName like ?</div><div>        //封装查询条件的</div><div>        TeacherExample example = new TeacherExample();</div><div>        example.setOrderByClause(&quot;id DESC&quot;);</div><div>        //1、使用example创建一个Criteria（查询准则）</div><div>        Criteria criteria = example.createCriteria();</div><div>        criteria.andIdEqualTo(1);</div><div>        criteria.andTeachernameLike(&quot;%a%&quot;);</div><div><br/></div><div>        System.out.println(&quot;======================&quot;);</div><div>        List&lt;Teacher&gt; list2 = mapper.selectByExample(example);</div><div>        for (Teacher teacher : list2) {</div><div>                System.out.println(teacher);</div><div>        }</div><div><br/></div><div>        /**</div><div>         * 多个复杂条件</div><div>         * select * from t_teacher where  (id=? and teacherName like ?) or (address like ? and birth bet)</div><div>         */</div><div>        TeacherExample example2 = new TeacherExample();</div><div><br/></div><div><br/></div><div>        //一个Criteria能封装一整个条件</div><div>        Criteria criteria2 = example2.createCriteria();</div><div>        criteria2.andIdGreaterThan(1);</div><div>        criteria2.andTeachernameLike(&quot;%a%&quot;);</div><div><br/></div><div>        //创建第二个查询条件</div><div>        Criteria criteria3 = example2.createCriteria();</div><div>        criteria3.andAddressLike(&quot;%%&quot;);</div><div>        criteria3.andBirthDateBetween(new Date(), new Date());</div><div><br/></div><div>        example2.or(criteria3);</div><div>        System.out.println(&quot;=======-=-=-=-=-=-=-&quot;);</div><div>        mapper.selectByExample(example2);</div><div><br/></div><div>    }</div><div><br/></div><div>    @Before</div><div>    public void initSqlSessionFactory() throws IOException {</div><div>        String resource = &quot;mybatis-config.xml&quot;;</div><div>        InputStream inputStream = Resources.getResourceAsStream(resource);</div><div>        sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);</div><div>    }</div><div><br/></div><div>}</div><div><br/></div></div><div><br/></div></span>
</div></body></html> 